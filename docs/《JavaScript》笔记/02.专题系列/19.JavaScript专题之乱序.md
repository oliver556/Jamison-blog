---
title: JavaScript 专题之乱序
date: 2021-11-08 17:01:02
permalink: /pages/25c514/
categories:
  - 前端技术
tags:
  - Web开发
  - JavaScript
  - 专题系列
author:
  name: Jamison
  link: https://github.com/oliver556
---

# JavaScript 专题之乱序

## 一. 乱序

乱序的意思就是将数组打乱。

嗯，没有了，直接看代码吧。

## 二. Math.random

一个经常会遇见的写法是使用 Math.random()：

```js
var values = [1, 2, 3, 4, 5];

values.sort(function(){
  return Math.random() - 0.5;
});

console.log(values);
```


`Math.random() - 0.5` 随机得到一个正数、负数或是 0，如果是正数则降序排列，如果是负数则升序排列，如果是 0 就不变，然后不断的升序或者降序，最终得到一个乱序的数组。

看似很美好的一个方案，实际上，效果却不尽如人意。不信我们写个 demo 测试一下：

```js
var times = [0, 0, 0, 0, 0];

for (var i = 0; i < 100000; i++) {
  let arr = [1, 2, 3, 4, 5];
  arr.sort(() => Math.random() - 0.5);
  times[arr[4]-1]++;
}

console.log(times);
```

测试原理是：将 `[1, 2, 3, 4, 5]` 乱序 10 万次，计算乱序后的数组的最后一个元素是 1、2、3、4、5 的次数分别是多少。

一次随机的结果为：

```
[30636, 30906, 20456, 11743, 6259]
```

该结果表示 10 万次中，数组乱序后的最后一个元素是 1 的情况共有 30636 次，是 2 的情况共有 30906 次，其他依此类推。

我们会发现，最后一个元素为 5 的次数远远低于为 1 的次数，所以这个方案是有问题的。

可是我明明感觉这个方法还不错呐？初见时还有点惊艳的感觉，为什么会有问题呢？

是的！我很好奇！

