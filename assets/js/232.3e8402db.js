(window.webpackJsonp=window.webpackJsonp||[]).push([[232],{567:function(s,a,t){"use strict";t.r(a);var n=t(7),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"一文搞定-npm-包发布与管理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一文搞定-npm-包发布与管理"}},[s._v("#")]),s._v(" 一文搞定 npm 包发布与管理")]),s._v(" "),a("blockquote",[a("p",[s._v("因为最近负责组内的基础能力建设，发布各种功能 / 插件包犹如家常便饭，所以熟悉对 npm 包的发布与管理是非常有必要的，故此有了本篇总结文章，方便以后查阅，也希望帮助到有需要的同学。")])]),s._v(" "),a("h2",{attrs:{id:"一-初始化-npm-项目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一-初始化-npm-项目"}},[s._v("#")]),s._v(" 一. 初始化 npm 项目")]),s._v(" "),a("p",[s._v("根据一下命令能初始化一个 npm 包项目，命令交互过程中会让你填入 项目名称、版本、作者等信息，可以直接回车跳过（命令最后增加 "),a("code",[s._v("-y")]),s._v(" 使用默认设置）。")]),s._v(" "),a("div",{staticClass:"language-shell script line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" init "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--save")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"二-包权限管理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二-包权限管理"}},[s._v("#")]),s._v(" 二. 包权限管理")]),s._v(" "),a("p",[s._v("很多时候，一个项目包往往不止是你一个人在管理的，这时需要给其他一起维护的同学开通发布的权限，相关使用命令如下：")]),s._v(" "),a("div",{staticClass:"language-shell script line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看模块 owner，其中 demo 为模块名")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" owner "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" demo\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 添加一个发布者，其中 xxx 为要添加同学的 npm 账号")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" owner "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" xxx demo\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除一个发布者")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" owner "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" xxx demo\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h2",{attrs:{id:"三-发布版本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三-发布版本"}},[s._v("#")]),s._v(" 三. 发布版本")]),s._v(" "),a("h3",{attrs:{id:"_1-发布稳定版本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-发布稳定版本"}},[s._v("#")]),s._v(" 1. 发布稳定版本")]),s._v(" "),a("p",[s._v("更新版本号共有以下选项（major | minor | patch | premajor | preminor | prepatch | prerelease）。")]),s._v(" "),a("blockquote",[a("p",[s._v("注意：项目的 git status 必须是 clear，才能使用这些命令。")])]),s._v(" "),a("div",{staticClass:"language-shell script line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# major 主版本号，并且不向下兼容  1.0.0 -> 2.0.0")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" version major\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# minor 次版本号，有新功能且向下兼容  1.0.0 -> 1.1.0")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" version minor\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# patch 修订号，修复一些问题、优化等  1.0.0 -> 1.0.1")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" version patch\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# premajor 预备主版本  1.0.0 -> 2.0.0-0")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" version premajor\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# preminor 预备次版本  1.0.0 -> 1.1.0-0")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" version major\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# prepatch 预备修订号版本  1.0.0 -> 1.0.1-0")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" version major\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# prerelease 预发布版本  1.0.0 -> 1.0.0-0")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" version major\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("p",[s._v("版本号更新后，我们就可以进行版本的发布")]),s._v(" "),a("div",{staticClass:"language-shell script line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" publish\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"_2-预发布版本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-预发布版本"}},[s._v("#")]),s._v(" 2. 预发布版本")]),s._v(" "),a("p",[s._v("很多时候一些新改动，并不能直接发布到稳定版本上（稳定版本的意思就是使用 "),a("code",[s._v("npm install demo")]),s._v(" 即可下载的最新版本），这时可以发布一个 “预发布版本”，不会影响到稳定版本。")]),s._v(" "),a("div",{staticClass:"language-shell script line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 发布一个 prerelease 版本，tag=beta")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" version prerelease\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" publish "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--tag")]),s._v(" beta\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("比如原来的版本号是 "),a("code",[s._v("1.0.")]),s._v("，那么以上发布后的版本是 "),a("code",[s._v("1.0.1-0")]),s._v("，用户可以通过 "),a("code",[s._v("npm install demo@beta")]),s._v(" 或者 "),a("code",[s._v("npm install demo@1.0.1-0")]),s._v(" 来安装，用户通过 "),a("code",[s._v("npm install demo")]),s._v(" 安装的还是 "),a("code",[s._v("1.0.1")]),s._v(" 版本。")]),s._v(" "),a("h3",{attrs:{id:"_3-将-beta-版本设置为稳定版"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-将-beta-版本设置为稳定版"}},[s._v("#")]),s._v(" 3. 将 beta 版本设置为稳定版")]),s._v(" "),a("div",{staticClass:"language-shell script line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 首先可以查看当前所有的最新版本，包括 prerelease 与稳定版本")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" dist-tag "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置 1.0.1-1 版本为稳定版本")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" dist-tag "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" demo@1.0.1-1 latest\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("这时候，latest 稳定版本已经是 "),a("code",[s._v("1.0.1-1")]),s._v(" 了，用户可以直接通过 "),a("code",[s._v("npm install demo")]),s._v(" 即可安装该版本。")]),s._v(" "),a("h3",{attrs:{id:"_4-将-beta-版本移出"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-将-beta-版本移出"}},[s._v("#")]),s._v(" 4. 将 beta 版本移出")]),s._v(" "),a("div",{staticClass:"language-shell script line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将 beta 版本移出")]),s._v("\n$ tnpm dist-tag "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" demo beta\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"_5-将-tag-推送到-git-远程仓库中"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-将-tag-推送到-git-远程仓库中"}},[s._v("#")]),s._v(" 5. 将 tag 推送到 Git 远程仓库中")]),s._v(" "),a("div",{staticClass:"language-shell script line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 当我们发布完对应的版本，可以通过以下命里将版本号推送到远程仓库，其中 xxx 对应分支")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" push origin xxx "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--tags")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h2",{attrs:{id:"四-发布版本规则"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四-发布版本规则"}},[s._v("#")]),s._v(" 四. 发布版本规则")]),s._v(" "),a("h3",{attrs:{id:"_1-alpha"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-alpha"}},[s._v("#")]),s._v(" 1. alpha")]),s._v(" "),a("ul",[a("li",[s._v("alpha："),a("strong",[s._v("内部版本")]),s._v("。此版本表示该软件在此阶段主要是以实现软件功能为主，通常只在软件开发者内部交流，一般而言，该版本软件的 Bug 较多，需要继续修改。")])]),s._v(" "),a("div",{staticClass:"language-shell script line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 发布 内部版本")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" publish "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--tag")]),s._v(" alpha \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"_2-beta"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-beta"}},[s._v("#")]),s._v(" 2. beta")]),s._v(" "),a("ul",[a("li",[s._v("beta："),a("strong",[s._v("公测版本")]),s._v("。该版本相对于 alpha 版已有了很大的改进，消除了严重的错误，但还是存在着一些缺陷，需要经过多次测试来进一步消除，此版本主要的修改对象是软件的 UI，这个阶段的版本也会一直加入新的功能。")])]),s._v(" "),a("div",{staticClass:"language-shell script line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 发布 公测版本")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" publish "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--tag")]),s._v(" beta\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"_3-rc"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-rc"}},[s._v("#")]),s._v(" 3. rc")]),s._v(" "),a("ul",[a("li",[s._v("rc：即 Release candiate，"),a("strong",[s._v("正式版本的候选版本")]),s._v("。 该版本已经相当成熟了，基本上不存在导致错误的 BUG，与即将发行的正式版相差无几，不会再加入新的功能了，主要着重于除错。")])]),s._v(" "),a("div",{staticClass:"language-shell script line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 发布 正式版本的候选版本")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" publish "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--tag")]),s._v(" rc\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h2",{attrs:{id:"五-查看版本信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#五-查看版本信息"}},[s._v("#")]),s._v(" 五. 查看版本信息")]),s._v(" "),a("p",[s._v("可以通过 "),a("code",[s._v("npm info")]),s._v(" 来查看模块的详细信息。")]),s._v(" "),a("div",{staticClass:"language-shell script line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" info\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);